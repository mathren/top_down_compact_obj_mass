% Define document class
\documentclass[twocolumn]{aastex63}
\DeclareRobustCommand{\Eqref}[1]{Eq.~\ref{#1}}
\DeclareRobustCommand{\Figref}[1]{Fig.~\ref{#1}}
\DeclareRobustCommand{\Tabref}[1]{Tab.~\ref{#1}}
\DeclareRobustCommand{\Secref}[1]{Sec.~\ref{#1}}
\newcommand{\todo}[1]{{\large $\blacksquare$~\textbf{\color{red}[#1]}}~$\blacksquare$}
% \usepackage{cuted}
\usepackage{flushend}

\graphicspath{{./figures/}}

\begin{document}

% Title
\title{Pair-instability mass loss for top-down compact object masses calculations}

% Author list
% \author{M. Renzo}

\begin{abstract}
  Population synthesis relies on semi-analytic formulae to determine
  masses of compact objects from the (helium or carbon-oxygen) core
  masses of collapsing stars. These are usually combined across
  different regimes, possibly introducing artificial features in the
  compact object mass function. Such artifacts impair the
  interpretation of gravitational wave data. We propose a different
  ``top-down'' implementation where, instead of relying on the
  fallback onto a ``proto-compact-object'' to get
  the final mass, we remove mass from the star for
  each possible mass-loss mechanism separately. Our approach can recover the existing
  implementation, while allowing continuity across the
  core-collapse/pulsational-pair-instability regime. It can be
  extended
  to other mass-loss mechanisms associated to the final collapse.\\

  \todo{show to Rob Farmer and invite?}
\end{abstract}

\section{Introduction}

Stellar and binary population synthesis calculations are necessary to
predict event rates and population statistics of astrophysical
phenomena involving neutron stars (NS) and
black holes (BH). Typically, at the end of the evolution (carbon
depletion) the core mass is mapped to a compact object mass, using a
$M_\mathrm{comp.\ obj}\equiv M_\mathrm{comp.\ obj}(M_\mathrm{core})$
informed by core-collapse (CC) simulations (e.g., \citealt{fryer:12,
  spera:15, mandel:20, couch:20}, see also \citealt{zapartas:21, patton:21}) and/or (pulsational) pair instability simulations
(e.g., \citealt{belczynski:16, woosley:17, spera:17, stevenson:19,
  marchant:19, farmer:19, costa:21}).

The most commonly adopted algorithms to obtain compact object masses
in the CC regime are the ``rapid'' and ``delayed''
prescriptions from \cite{fryer:12}. In both cases, the compact object
is built ``bottom-up'', from a proto-NS mass adding the amount of
fallback expected in the (possibly failed) explosion. However, the
proto-NS mass, and the information about the core structure relevant
to decide the fallback are usually not available in population
synthesis \citep[e.g.,][]{patton:20} -- conversely the total mass of
the star is arguably better known. % Various algorithms are used for the
% PPI regime, including \cite{belczynski:16, stevenson:19, marchant:19},
% and \cite{farmer:19}.

At the transition between CC and pulsational
pair-instability (PPI, roughly at carbon-oxygen cores of
$\sim{}35\,M_\odot$, \citealt{woosley:17, marchant:19, renzo:20csm,
  costa:21}), a mismatch between the fitting formulae caused by the
different stellar structures underlying these algorithms can introduce
artifacts. These impair the interpretation of gravitational-wave data
\citep[see, e.g., the corresponding feature in Fig.~5
of][]{vanson:21}. While it is possible that the BH mass function is
discontinuous at the onset of the PPI regime (e.g.,
\citealt{renzo:20conv,costa:21}, Hendriks et al., in prep.), the
location and amplitude of a putative discontinuity should not be
governed by a mismatch between fitting formulae to different stellar
evolution models.

\section{Top-down compact object masses}

In contrast with the state-of-the-art  ``bottom up'' approach of
\cite{fryer:12}, we propose a ``top-down'' way to build the compact object masses
$M_\mathrm{comp.\ obj}$, starting from the total stellar mass and
removing the amount of mass lost because of all the processes that may
occur at CC:

% \todo{The most common algorithm are from Fryer+12, where the compact
%   object mass if build from a proto-NS mass adding fallback (bottom-up).}\\
% \todo{pop. synth. knows total masses, while core masses are poorly
%   characterized (e.g., lacking composition informaton,
%   \citealt{patton:20}). While counterintuitive to core-collapse
%   theorists, it is easier to build the compact object core mass from
%   the total mass at pre-collapse minus all the SN mass loss term
%   (top-down):}\\

\begin{widetext}
  \begin{equation}
    \label{eq:mass}
    M_\mathrm{comp.\ obj} = M_\mathrm{pre-CC} - \left(\Delta M_\mathrm{SN} + \Delta M_{\nu, \mathrm{core}} + \Delta M_\mathrm{NLW} + \Delta M_\mathrm{PPI} + \cdots \right)
  \end{equation}
\end{widetext}

where all masses are in $M_\odot$ units, $M_\mathrm{pre-CC}$ is the
total mass at the onset of CC, and each term in the
parenthesis correspond to a potential mass-loss mechanism:
$\Delta M_\mathrm{SN}$ for the SN ejecta,
$\Delta M_{\nu, \mathrm{core}}$ the change in gravitational mass of
the core due to the neutrino losses, $\Delta M_\mathrm{NLW}$ the
\cite{nadezhin:80, lovegrove:13} loss of the envelope due to
$\Delta M_{\nu, \mathrm{core}}$, $\Delta M_\mathrm{PPI}$ the
pulsational mass loss due to pair-instability. Each term can be a
function of the stellar or binary properties, and more mass loss
mechanism can be added (e.g., disk wind). Each term in parenthesis for
\Eqref{eq:mass} can be theoretically or observationally informed
(e.g., $\Delta M_\mathrm{SN}$ might be derived from light curves of
large samples of observed SNe).

In the CC regime, the previous approach can be recovered by setting
$\Delta M_\mathrm{SN} + \Delta M_{\nu, \mathrm{core}} = M_\mathrm{pre-CC} - M_\mathrm{comp.\ obj}^\mathrm{Fryer+12}$,
where the last term is the compact object mass predicted by
\cite{fryer:12} and ignoring other mass loss terms
($\Delta M_\mathrm{PPI}\equiv 0, \ \Delta M_\mathrm{NLW}\equiv0$).

\section{New fit for PPI ejecta}

With the top-down approach of \Eqref{eq:mass}, imposing that
$\Delta M_\mathrm{PPI}=0$ at the edge of the PPI regime,
\Eqref{eq:mass} produces by construction a smooth BH mass
distribution. We fit the metallicity-dependent naked helium core PPI
simulations of \cite{farmer:19} to obtain
$\Delta M_\mathrm{PPI} \equiv \Delta M_\mathrm{PPI}(M_\mathrm{CO},Z)$ as
a function of the carbon-oxygen core mass. While the fit of
\cite{farmer:19} provides the remaining mass after PPI, this is only
an estimate of the BH mass because of other mass loss processes that
might occurr \citep[e.g.,][]{renzo:20csm, powell:21, rahman:22}. Our approach
fits the mass removed by PPI only, which is what is actually computed
in \cite{farmer:19}.

\input{fit_DM_PPI.tex} %% generated by src/figures/fit_DM_PPI.py

The dashed curves in each panel of \Figref{fig:fit_DM_PPI} show the
fit \Eqref{eq:fit} for each metallicity computed in
\cite{farmer:19}. We neglect the (weak) metallicity dependence of the
minimum core mass for PPI, and we fit the data for initial He core
masses between $38-60\,M_\odot$.  We emphasize that \cite{farmer:19}
only simulated helium cores, and with a similar setup
\cite{renzo:20csm} showed that in the case of an H-rich envelope still
present at the onset of pulsation, this is easily removed: to the
$\Delta M_\mathrm{PPI}$ provided here one should add the entire H-rich
envelope if present.

The amount of mass lost in PPI is sensitive to convection
\cite{renzo:20conv} and nuclear reaction rates \cite{farmer:19,
  farmer:20, costa:21, woosley:21, mehta:21}, which overall introduce
up to $\sim{}20\%$ uncertainties on the maximum BH mass. The accuracy
of our fit is comparable to these uncertainties.

\begin{figure}[ht!]
    \begin{centering}
      \includegraphics[width=0.75\linewidth]{fit_DM_PPI.pdf}
      \caption{Each panel show our fitting formula \Eqref{eq:fit} for
        the amount of PPI mass-loss as a function of carbon-oxygen
        core mass at each metallicity $Z$ computed in
        \cite{farmer:19}. The crosses show the values from Tab.~1
        \cite{farmer:19}.}
        % This label tells showyourwork that the script `figures/fit_DM_PPI.py'
        % generates the PDF included above
        \label{fig:fit_DM_PPI}
    \end{centering}
\end{figure}

\bibliography{./top_down_comp_obj_mass.bib}
\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
